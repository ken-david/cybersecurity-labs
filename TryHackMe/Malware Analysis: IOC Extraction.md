# Malware Analysis: File Inspection & IOC Extraction
A hands-on malware investigation using PeStudio and CyberChef

## Scenario
It’s the middle of the night shift, and you’re the only analyst on duty in the SOC. A manager urgently reports that a suspicious executable was found on a user’s machine and requires immediate investigation.

Upon initial inspection, the file claims to be a legitimate Windows updater. However, multiple EDR alerts are triggered, raising concerns about potential malicious activity. Your task is to analyze the file, identify indicators of compromise (IOCs), and determine whether it poses a threat to the environment.

## Objective
- Perform static analysis on a suspicious executable
- Identify file properties and cryptographic hashes
- Extract potential Indicators of Compromise (IOCs)
- Analyze suspicious strings and network-related artifacts

## Tools Used 
- PeStudio – Static analysis of Windows executables
- CyberChef – Decoding and data transformation

## File Information
- windows-update.exe

## Q1: What is the architecture of the binary file windows-update.exe?
To begin the investigation, I performed static analysis using PeStudio, a free and portable tool commonly used by SOC analysts to assess Windows executables without executing them.

PeStudio analyzes file headers, imports, strings, and resources while highlighting suspicious indicators using a color-coded scoring system.

The file was loaded into PeStudio via drag-and-drop.

<img width="738" height="502" alt="image" src="https://github.com/user-attachments/assets/ba0b0abd-e96c-4a58-a776-74ea7dd6047d" />

**Answer:** 64-bit

## Q2: What is the SHA-256 hash of the file windows-update.exe?

Within PeStudio, the cryptographic hashes of the file are automatically calculated. These hashes can later be used for threat intelligence lookups and correlation across security tools.

<img width="746" height="506" alt="image" src="https://github.com/user-attachments/assets/c4f19d91-b7f6-455a-b652-4c1903b8d392" />


Answer: SHA-256 hash identified in PeStudio

## Q3: Identify a URL within the file that can be used as an IOC

While reviewing the Strings section in PeStudio, I identified a hardcoded URL embedded in the binary. This strongly suggests potential command-and-control or payload download behavior.

(screenshot here)

Answer:
http://tryhatme.com/update/security-update.exe

## Q4: Identify a domain within the file that can be used as an IOC

Continuing through the strings output, additional network-related artifacts were discovered. One domain stood out as suspicious and suitable for use as an IOC.

(screenshot here)

Answer:
responses.tryhatme.com

## Q5: Input the decoded flag from the suspicious domain

Alongside the suspicious domain, an encoded string was discovered that appeared to be meaningful once decoded.

To analyze this, I used CyberChef, a web-based tool commonly used by SOC analysts for decoding, deobfuscation, and data transformation.

(screenshot here)

After decoding the string:

Answer:
THM{you_g0t_some_IOCs_friend}

## Q6: What library related to socket communication is loaded by the binary?

Reviewing the Imports section in PeStudio revealed a Windows library commonly associated with network and socket communication. This further supports the likelihood of outbound network activity.

(screenshot here)

Answer:
WS2_32.dll

## Conclusion

Through static analysis, this investigation identified multiple red flags indicating malicious behavior:

The file masquerades as a legitimate Windows updater

Embedded URLs and domains suitable for IOC creation

Network-related libraries indicating socket communication

Encoded data suggesting obfuscation techniques

This exercise demonstrates a structured SOC workflow for malware triage, IOC extraction, and threat identification using industry-standard tools.

